<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/stylesheets/userPage.css">
    <title>Drip Work - <%=currentUser.username%></title>
</head>
<body>
    <h1 id='userPageTitle' data-elapsed-time-working="<%=userInfo.elapsedTimeWorking%>">This is the page of <%=currentUser.username%></h1>
    <h4>Congratulations, you have worked for: <%=userInfo.workSessions.length%> sessions</h4>
    <label for="workedTimeDisplay">Total Elapsed Time Working [in <span id='displayTimeUnit'>Hours</span>]: <span id='elapsedTimeWorking'><%=(userInfo.elapsedTimeWorking/3600000).toFixed(2)%></span></label>

    <select name="workedTimeDisplay" id="workedTimeDisplay">
      <option value="Days">Days</option>
      <option selected value="Hours">Hours</option>
      <option value="Minutes">Minutes</option>
      <option value="Seconds">Seconds</option>
    </select>
    <br>
    <label for="topicDisplaySelection">Topic You Want To Be Shown:</label>

    <select name="topicDisplaySelection" id="topicDisplaySelection">
      <% userTopics.forEach ((topic) => { %>
        <option value=<%=topic%>+ "Topic"><%=topic%></option>
      <% }); %>
      <option value="Caminar">Caminar</option>
      <option value="Saltar">Saltar</option>
      <option value="All">All Sessions</option>
    </select>
    <br><br>
    <div id="userDisplayDiv">
        <table>
            <thead>
                <tr>
                    <td>Topic</td>
                    <td>Date</td>
                    <td>Target (s)</td>
                    <td>Real (s)</td>
                    <td>Completion Rating [0-10]</td>
                    <td>Details</td>
                </tr>
            </thead>
            <tbody id='sessionsDisplayTableBody'>
            </tbody>
        </table>
        <a href="/">Landing Page</a>
        <a href="/schedule">Schedule</a>
    </div>

    <div class="modal" id="modal-one">
        <div class="modal-bg modal-exit"></div>
        <div class="modal-container">
          <h3>Welcome to this session's statistics</h3>
          <p><strong>Topic: </strong><span id='modalSessionTopic'></span></p>
          <p><strong>Date: </strong><span id='modalMissionDate'></span></p>
          <p><strong>Target Duration (s): </strong><span id='modalMissionTargetDuration'></span></p>
          <p><strong>Real Duration (s): </strong><span id='modalMissionRealDuration'></span></p>
          <p><strong>Completion Rating [0-10]: </strong><span id='modalMissionCompletionRating'></span></p>
          <hr>
          <h3>Comments (Before Starting):</h3>
          <p id='sessionBeforeComments'></p>
          <hr>
          <div id="sessionMissionsDiv">
            <h3>Missions for this session:</h3>
            <ul id='modalMissionsDisplay'></ul>
          </div>
          <button class="modal-close modal-exit">X</button>
          <ul id='modalMissionsDisplay'></ul>
          <hr>
          <p><strong>After Comments: </strong><span id='modalAfterComments'></span></p>
          <button id='closeModalBtn' class="modal-exit">Close</button>
        </div>
      </div>

    <div class="bottomNavbar">
        <a href="/">Landing</a>
        <% if(!currentUser){ %>
            <a href="/login">Login</a>
            <a href="/register">Register</a>
        <% } else { %>
            <a href="/users/<%=currentUser.username%>"><span id='currentUser'><%=currentUser.username%></span></a>
            <a href="/logout">Logout</a>
        <% } %>
    </div>

    <script src='/scripts/userScript.js'></script>
</body>
</html>